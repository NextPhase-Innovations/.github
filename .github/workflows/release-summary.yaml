
# ==============================================================
# 3️⃣ release-summary.yml — Append Release Info to Central Repo
# ==============================================================
name: Update Central Release Log
on:
  workflow_call:
    inputs:
      project_name:
        required: true
        type: string
      version:
        required: true
        type: string
      changelog:
        required: false
        type: string

jobs:
  update-log:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout central repo
        uses: actions/checkout@v4
        with:
          repository: NextPhase-Innovations/nextphase-releases
          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

      - name: Append new release info
        run: |
          echo "### 🔹 ${{ inputs.project_name }} v${{ inputs.version }} — $(date '+%Y-%m-%d')" >> releases.md
          if [ ! -z "${{ inputs.changelog }}" ]; then
            echo "${{ inputs.changelog }}" >> releases.md
          fi
          echo "" >> releases.md

      - name: Commit & push
        run: |
          git config user.name "NextPhase Bot"
          git config user.email "melissa@nextphaseinnovations.ai"
          git add releases.md
          git commit -m "Update release log for ${{ inputs.project_name }} v${{ inputs.version }}"
          git push
